<div class="artist-page-spotify" 
     x-data="{
        artist: {},
        topSongs: [],
        allSongs: [],
        albums: [],
        relatedArtists: [],
         
        playThisIs: async function() {
            if (!this.allSongs || this.allSongs.length === 0) {
                console.error('[This Is] Nenhuma m√∫sica dispon√≠vel');
                return;
            }
            
            console.log('[This Is] Tocando essenciais de ' + this.artist.name + '...');
            console.log('[This Is] ' + this.allSongs.length + ' m√∫sicas do artista carregadas');
            
            Alpine.store('player').setQueue(this.allSongs);
            Alpine.store('player').playTrack(this.allSongs[0]);
        },
        
        playArtistRadio: async function(type) {
            type = type || 'mix';
            
            if (!this.topSongs || this.topSongs.length === 0) {
                console.error('Nenhuma m√∫sica dispon√≠vel para iniciar r√°dio');
                return;
            }
            
            const typeNames = {
                'hits': 'R√°dio Popular',
                'deep': 'R√°dio Profundo', 
                'mix': 'R√°dio Mix'
            };
            
            console.log('[R√°dio] Iniciando ' + typeNames[type] + '...');
            
            try {
                const response = await fetch('/api/radio/' + this.topSongs[0].videoId);
                const data = await response.json();
                
                if (data.success && data.radio && data.radio.tracks) {
                    let tracks = data.radio.tracks;
                    
                    if (type === 'hits') {
                        tracks = tracks.slice(0, 30);
                        console.log('[R√°dio Popular] ' + tracks.length + ' hits carregados');
                    } else if (type === 'deep') {
                        tracks = tracks.slice(10, 50);
                        console.log('[R√°dio Profundo] ' + tracks.length + ' m√∫sicas menos conhecidas carregadas');
                    } else {
                        console.log('[R√°dio Mix] ' + tracks.length + ' m√∫sicas variadas carregadas');
                    }
                    
                    Alpine.store('player').setQueue(tracks);
                    Alpine.store('player').playTrack(tracks[0]);
                } else {
                    console.error('[R√°dio] Resposta inv√°lida:', data);
                }
            } catch (error) {
                console.error('[R√°dio] Erro ao carregar:', error);
            }
        },
        
        playItem: function(item) {
            if (item.videoId && window.Alpine && Alpine.store('player')) {
                var track = {
                    videoId: item.videoId,
                    title: item.title,
                    artist: this.getArtistName(item),
                    thumbnails: item.thumbnails || []
                };
                Alpine.store('player').playTrack(track);
            }
        },
        
        getArtistName: function(item) {
            if (item.artists && item.artists.length > 0) {
                return item.artists[0].name;
            }
            return 'Artista desconhecido';
        },
        
        handleItemClick: function(item) {
            console.log('Item clicado:', item);
            
            // Detectar artista: tem browseId mas n√£o tem videoId, ou tem subscribers
            var isArtist = (item.browseId && !item.videoId) || item.subscribers;
            
            if (isArtist && item.browseId) {
                console.log('Navegando para artista:', item.title || item.name);
                if (window.navigateTo) {
                    window.navigateTo('/pages/artist/' + item.browseId);
                } else if (window.htmx) {
                    htmx.ajax('GET', '/pages/artist/' + item.browseId, {
                        target: '#main-content',
                        swap: 'innerHTML'
                    });
                    history.pushState({url: '/pages/artist/' + item.browseId}, '', '/pages/artist/' + item.browseId);
                }
            } else if (item.browseId && !item.videoId) {
                console.log('Abrindo √°lbum/playlist:', item.title);
            } else if (item.videoId) {
                console.log('Tocando m√∫sica:', item.title);
                this.playItem(item);
            }
        },
        
        getHighResThumbnail: function(url) {
            if (!url) return '/static/images/placeholder.jpg';
            return '/api/image-proxy?url=' + encodeURIComponent(url);
        }
     }"
    x-init='
        artist = {{ artist|tojson }};
        topSongs = {{ topSongs|tojson }};
        allSongs = {{ allSongs|tojson }};
        albums = {{ albums|tojson }};
        relatedArtists = {{ relatedArtists|tojson }};
        
        // Scroll autom√°tico para o topo ao carregar novo artista
        window.scrollTo({ top: 0, behavior: "smooth" });
        
        // Debug: Verificar artistas relacionados
        if (relatedArtists && relatedArtists.length > 0) {
            console.log("[DEBUG] Artistas Relacionados:");
            console.log("  - Total:", relatedArtists.length);
            console.log("  - Primeiro artista:", relatedArtists[0]);
            console.log("  - Nome do primeiro:", relatedArtists[0].name || relatedArtists[0].title || "SEM NOME");
        }
        
        console.log("[DEBUG] M√∫sicas dispon√≠veis:");
        console.log("  - topSongs (para exibir):", topSongs.length);
        console.log("  - allSongs (para This Is):", allSongs.length);
     '>
   
   <!-- ==================== HEADER/HERO ESTILO SPOTIFY ==================== -->
   <header class="artist-hero-spotify" 
           style="background: linear-gradient(180deg, rgba(6, 182, 212, 0.3) 0%, rgba(18, 18, 18, 1) 100%); padding: 6rem 2rem 2rem 2rem;">
       <div style="max-width: 1400px; margin: 0 auto; display: flex; align-items: flex-end; gap: 1.5rem;">
          <!-- Foto do artista -->
          <div style="position: relative; flex-shrink: 0; width: 232px; height: 232px;">
              <div style="position: absolute; inset: 0; background: linear-gradient(135deg, rgba(6, 182, 212, 0.4), rgba(59, 130, 246, 0.4)); border-radius: 50%; filter: blur(60px); z-index: 0;"></div>
              <img :src="getHighResThumbnail(artist.thumbnails?.[0]?.url)"
                   :alt="artist.name"
                   style="position: relative; width: 100%; height: 100%; border-radius: 50%; object-fit: cover; object-position: center; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5); z-index: 1; background: rgba(31, 41, 55, 0.5);"
                   onerror="if(this.src !== '/static/images/placeholder.jpg') { this.src='/static/images/placeholder.jpg'; this.onerror=null; }">
          </div>
           
           <!-- Info do artista -->
           <div style="flex: 1;">
               <p style="color: #22d3ee; font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem; text-transform: uppercase;">Artista</p>
               <h1 style="font-size: 4rem; font-weight: 900; color: white; margin-bottom: 1rem; line-height: 1;" 
                   x-text="artist.name">Artista</h1>
               <p style="color: #9ca3af; font-size: 1rem;"
                  x-text="`${artist.subscribers || '0'} ouvintes mensais`">0 ouvintes mensais</p>
           </div>
       </div>
       
       <!-- Bot√£o Seguir -->
       <div style="max-width: 1400px; margin: 0 auto; padding: 2rem 2rem 0 2rem;">
           <button class="spotify-follow-button"
                   style="padding: 12px 32px; background: transparent; border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 500px; color: white; font-size: 0.875rem; font-weight: 700; cursor: pointer; transition: all 0.3s; text-transform: uppercase; letter-spacing: 0.1em;"
                   onmouseover="this.style.background='rgba(255, 255, 255, 0.1)'; this.style.borderColor='rgba(255, 255, 255, 0.5)'; this.style.transform='scale(1.04)'"
                   onmouseout="this.style.background='transparent'; this.style.borderColor='rgba(255, 255, 255, 0.3)'; this.style.transform='scale(1)'">
               Seguir
           </button>
       </div>
   </header>

   <div style="max-width: 1400px; margin: 0 auto; padding: 0 2rem 4rem 2rem;">
       
       <!-- ==================== SE√á√ÉO "Popular" ==================== -->
       <section style="margin-top: 3rem; margin-bottom: 3rem;">
           <h2 style="font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 1.5rem;">
               Popular
           </h2>
           
           <!-- Lista de m√∫sicas populares -->
           <div class="spotify-popular-list">
               <template x-for="(song, index) in topSongs.slice(0, 5)" :key="song.videoId">
                   <div @click="playItem(song)"
                        class="spotify-song-row"
                        style="display: grid; grid-template-columns: 32px 40px 1fr auto; gap: 1rem; align-items: center; padding: 0.5rem; border-radius: 4px; cursor: pointer; transition: all 0.2s;"
                        onmouseover="this.style.background='rgba(255, 255, 255, 0.1)'"
                        onmouseout="this.style.background='transparent'">
                       
                       <!-- N√∫mero -->
                       <div style="color: #9ca3af; font-size: 1rem; font-weight: 400; text-align: right;"
                            x-text="index + 1"></div>
                       
                       <!-- Thumbnail 40x40 -->
                       <img :src="getHighResThumbnail(song.thumbnails?.[0]?.url)"
                            :alt="song.title"
                            style="width: 40px; height: 40px; border-radius: 4px; object-fit: cover;"
                            onerror="if(this.src !== '/static/images/placeholder.jpg') { this.src='/static/images/placeholder.jpg'; this.onerror=null; }">
                       
                       <!-- Nome da m√∫sica -->
                       <div style="min-width: 0;">
                           <p style="color: white; font-size: 1rem; font-weight: 400; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"
                              x-text="song.title"></p>
                       </div>
                       
                       <!-- Dura√ß√£o -->
                       <div style="color: #9ca3af; font-size: 0.875rem; font-weight: 400;"
                            x-text="song.duration || ''"></div>
                   </div>
               </template>
               
               <!-- Empty State -->
               <div x-show="topSongs.length === 0" 
                    style="color: #9ca3af; font-size: 0.875rem; text-align: center; padding: 2rem; font-style: italic;">
                   Nenhuma m√∫sica popular dispon√≠vel
               </div>
           </div>
       </section>

       <!-- ==================== SE√á√ÉO "Popular releases" ==================== -->
       <section style="margin-bottom: 3rem;">
           <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
               <h2 style="font-size: 1.5rem; font-weight: 700; color: white;">
                   Popular releases
               </h2>
               <a href="#" style="color: #9ca3af; font-size: 0.875rem; font-weight: 700; text-decoration: none; text-transform: uppercase; letter-spacing: 0.05em; transition: color 0.2s;"
                  onmouseover="this.style.color='white'"
                  onmouseout="this.style.color='#9ca3af'">
                   Mostrar tudo
               </a>
           </div>
           
           <!-- Grid de releases -->
           <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1.5rem;">
               <template x-for="album in albums.slice(0, 6)" :key="album.browseId">
                   <div @click="handleItemClick(album)"
                        class="spotify-card"
                        style="background: rgba(31, 41, 55, 0.3); backdrop-filter: blur(20px); border-radius: 8px; padding: 1rem; cursor: pointer; transition: all 0.3s; border: 1px solid rgba(255, 255, 255, 0.05); position: relative;"
                        onmouseover="this.style.background='rgba(31, 41, 55, 0.5)'; this.style.transform='translateY(-4px)'"
                        onmouseout="this.style.background='rgba(31, 41, 55, 0.3)'; this.style.transform='translateY(0)'">
                       
                       <!-- Capa -->
                       <img :src="getHighResThumbnail(album.thumbnails?.[0]?.url)"
                            :alt="album.title"
                            style="width: 100%; aspect-ratio: 1/1; border-radius: 4px; object-fit: cover; margin-bottom: 1rem; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);"
                            onerror="if(this.src !== '/static/images/placeholder.jpg') { this.src='/static/images/placeholder.jpg'; this.onerror=null; }">
                       
                       <!-- T√≠tulo -->
                       <p style="color: white; font-size: 1rem; font-weight: 700; line-height: 1.4; margin-bottom: 0.5rem; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;"
                          x-text="album.title"></p>
                       
                       <!-- Meta (Ano ‚Ä¢ Tipo) -->
                       <p style="color: #9ca3af; font-size: 0.875rem; font-weight: 400;"
                          x-text="`${album.year || '2025'} ‚Ä¢ ${album.type || 'Album'}`"></p>
                   </div>
               </template>
               
               <!-- Empty State -->
               <div x-show="albums.length === 0" 
                    style="color: #9ca3af; font-size: 0.875rem; text-align: center; padding: 2rem; font-style: italic; grid-column: 1 / -1;">
                   Nenhum √°lbum dispon√≠vel
               </div>
           </div>
       </section>

      <!-- ==================== SE√á√ÉO "Apresentando [Artista]" ==================== -->
      <section style="margin-bottom: 3rem;">
          <h2 style="font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 1.5rem;"
              x-text="`Apresentando ${artist.name || 'Artista'}`">
              Apresentando Artista
          </h2>
           
           <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
              <!-- Card "This Is [Artist]" -->
              <div @click="playThisIs()"
                   style="background: linear-gradient(135deg, #0891b2, #2563eb); border-radius: 8px; padding: 2rem; cursor: pointer; transition: all 0.3s; position: relative; overflow: hidden; min-height: 160px; display: flex; flex-direction: column; justify-content: flex-end;"
                   onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 20px 40px rgba(0, 0, 0, 0.4)'"
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                  
                  <div style="position: absolute; top: 1rem; right: 1rem; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); padding: 0.25rem 0.75rem; border-radius: 500px; font-size: 0.7rem; font-weight: 700; color: white;">
                      ‚≠ê ESSENCIAL
                  </div>
                  
                  <p style="color: white; font-size: 2rem; font-weight: 900; margin-bottom: 0.5rem;"
                     x-text="`This Is ${artist.name || 'Artista'}`">This Is Artista</p>
                  <p style="color: rgba(255, 255, 255, 0.9); font-size: 0.875rem;">
                      As essenciais do artista.
                  </p>
              </div>
               
              <!-- Card "R√°dio Popular" -->
              <div @click="playArtistRadio('hits')"
                   style="background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 8px; padding: 2rem; cursor: pointer; transition: all 0.3s; position: relative; overflow: hidden; min-height: 160px; display: flex; flex-direction: column; justify-content: flex-end;"
                   onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 20px 40px rgba(0, 0, 0, 0.4)'"
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                  
                  <div style="position: absolute; top: 1rem; right: 1rem; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); padding: 0.25rem 0.75rem; border-radius: 500px; font-size: 0.7rem; font-weight: 700; color: white;">
                      üî• HITS
                  </div>
                  
                  <p style="color: white; font-size: 2rem; font-weight: 900; margin-bottom: 0.5rem;">
                      R√°dio Popular</p>
                  <p style="color: rgba(255, 255, 255, 0.9); font-size: 0.875rem;">
                      Hits + artistas similares.
                  </p>
              </div>
              
              <!-- Card "R√°dio Profundo" -->
              <div @click="playArtistRadio('deep')"
                   style="background: linear-gradient(135deg, #8b5cf6, #7c3aed); border-radius: 8px; padding: 2rem; cursor: pointer; transition: all 0.3s; position: relative; overflow: hidden; min-height: 160px; display: flex; flex-direction: column; justify-content: flex-end;"
                   onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 20px 40px rgba(0, 0, 0, 0.4)'"
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                  
                  <div style="position: absolute; top: 1rem; right: 1rem; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); padding: 0.25rem 0.75rem; border-radius: 500px; font-size: 0.7rem; font-weight: 700; color: white;">
                      üéß DEEP
                  </div>
                  
                  <p style="color: white; font-size: 2rem; font-weight: 900; margin-bottom: 0.5rem;">
                      R√°dio Profundo</p>
                  <p style="color: rgba(255, 255, 255, 0.9); font-size: 0.875rem;">
                      Descubra m√∫sicas menos conhecidas.
                  </p>
              </div>
              
              <!-- Card "R√°dio Mix" -->
              <div @click="playArtistRadio('mix')"
                   style="background: linear-gradient(135deg, #10b981, #059669); border-radius: 8px; padding: 2rem; cursor: pointer; transition: all 0.3s; position: relative; overflow: hidden; min-height: 160px; display: flex; flex-direction: column; justify-content: flex-end;"
                   onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 20px 40px rgba(0, 0, 0, 0.4)'"
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                  
                  <div style="position: absolute; top: 1rem; right: 1rem; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); padding: 0.25rem 0.75rem; border-radius: 500px; font-size: 0.7rem; font-weight: 700; color: white;">
                      üéµ MIX
                  </div>
                  
                  <p style="color: white; font-size: 2rem; font-weight: 900; margin-bottom: 0.5rem;">
                      R√°dio Mix</p>
                  <p style="color: rgba(255, 255, 255, 0.9); font-size: 0.875rem;">
                      Variedade balanceada de m√∫sicas.
                  </p>
              </div>
           </div>
       </section>

      <!-- ==================== SE√á√ÉO "F√£s tamb√©m curtem" ==================== -->
      <section style="margin-bottom: 3rem;">
          <h2 style="font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 1.5rem;">
              F√£s tamb√©m curtem
          </h2>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 1.5rem;">
              <template x-for="relatedArtist in relatedArtists.slice(0, 8)" :key="relatedArtist.browseId">
                  <div @click="handleItemClick(relatedArtist)"
                       class="spotify-artist-card"
                       style="background: rgba(31, 41, 55, 0.3); backdrop-filter: blur(20px); border-radius: 8px; padding: 1rem; cursor: pointer; transition: all 0.3s; border: 1px solid rgba(255, 255, 255, 0.05); text-align: center;"
                       onmouseover="this.style.background='rgba(31, 41, 55, 0.5)'; this.style.transform='translateY(-4px)'"
                       onmouseout="this.style.background='rgba(31, 41, 55, 0.3)'; this.style.transform='translateY(0)'">
                      
                      <!-- Foto REDONDA -->
                      <img :src="getHighResThumbnail(relatedArtist.thumbnails?.[0]?.url)"
                           :alt="relatedArtist.name || relatedArtist.title"
                           style="width: 100%; aspect-ratio: 1/1; border-radius: 50%; object-fit: cover; margin-bottom: 1rem; box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);"
                           onerror="if(this.src !== '/static/images/placeholder.jpg') { this.src='/static/images/placeholder.jpg'; this.onerror=null; }">
                      
                      <!-- Nome -->
                      <p style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 0.5rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"
                         x-text="relatedArtist.name || relatedArtist.title || 'Artista'"></p>
                      
                      <!-- Badge "Artista" -->
                      <p style="color: #9ca3af; font-size: 0.875rem; font-weight: 400; text-transform: capitalize;">
                          Artista
                      </p>
                  </div>
               </template>
               
               <!-- Empty State -->
               <div x-show="relatedArtists.length === 0" 
                    style="color: #9ca3af; font-size: 0.875rem; text-align: center; padding: 2rem; font-style: italic; grid-column: 1 / -1;">
                   Nenhum artista relacionado dispon√≠vel
               </div>
           </div>
       </section>

       <!-- ==================== FOOTER "Followers" ==================== -->
       <footer style="margin-top: 4rem; padding-top: 2rem; border-top: 1px solid rgba(255, 255, 255, 0.1); text-align: center;">
           <p style="color: #9ca3af; font-size: 0.875rem;"
              x-text="`${artist.subscribers || '0'} seguidores`">
               0 seguidores
           </p>
       </footer>
   </div>
</div>
